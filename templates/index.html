<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telekinesis - P2P File Transfer</title>
    <link rel="stylesheet" href="/static/main_style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
    <link rel="manifest" href="/static/favicon/site.webmanifest">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-share-alt"></i>
                <h1>Telekinesis</h1>
            </div>
            <p class="subtitle">Keeping it together</p>
        </header>

        <!-- Connection Status -->
        <div class="status-bar" id="statusBar">
            <div class="status-indicator" id="statusIndicator">
                <i class="fas fa-circle"></i>
                <span id="statusText">Disconnected</span>
            </div>
            <button class="disconnect-btn" id="disconnectBtn" style="display: none;">
                <i class="fas fa-times"></i> Disconnect
            </button>
            <button class="disconnect-btn" id="resetBtn" style="display: none;">
                <i class="fas fa-refresh"></i> Start New Connection
            </button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Connection Setup Section -->
            <div class="section" id="connectionSection">
                <h2><i class="fas fa-plug"></i> Connection Setup</h2>
                <p class="section-description">Choose how you want to connect with another peer</p>
                
                <div class="connection-options">
                    <div class="option-card">
                        <h3><i class="fas fa-rocket"></i> Start Connection (Initiator)</h3>
                        <p>Create a connection offer and share it with the other person</p>
                        <div class="button-row">
                            <button class="btn btn-primary" id="createOfferBtn">
                                <i class="fas fa-play"></i> Create Offer
                            </button>
                        </div>
                    </div>
                    
                    <div class="option-card">
                        <h3><i class="fas fa-handshake"></i> Join Connection (Responder)</h3>
                        <p>Paste the offer from the other person or upload offer file</p>
                        <textarea id="offerInput" placeholder="Paste the connection offer here..." rows="4"></textarea>
                        <div class="button-row">
                            <button class="btn btn-secondary" id="createAnswerBtn">
                                <i class="fas fa-reply"></i> Create Answer
                            </button>
                            <input type="file" id="offerFileInput" accept=".txt" hidden>
                            <button class="btn btn-outline" onclick="document.getElementById('offerFileInput').click()">
                                <i class="fas fa-upload"></i> Upload Offer File
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Signaling Data Display -->
                <div class="signaling-data" id="signalingData" style="display: none;">
                    <h3 id="signalingTitle">Connection Data</h3>
                    <div class="data-container">
                        <textarea id="signalingContent" readonly rows="6"></textarea>
                        <div class="data-actions">
                            <button class="btn btn-outline" id="copyBtn">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button class="btn btn-outline" id="downloadBtn">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                    <p class="instruction-text" id="instructionText"></p>
                </div>

                <!-- Answer Input Section -->
                <div class="answer-section" id="answerSection" style="display: none;">
                    <h3><i class="fas fa-reply-all"></i> Complete Connection</h3>
                    <p>Paste the answer from the other person or upload answer file</p>
                    <textarea id="answerInput" placeholder="Paste the connection answer here..." rows="4"></textarea>
                    <div class="button-row">
                        <button class="btn btn-success" id="setAnswerBtn">
                            <i class="fas fa-check"></i> Complete Connection
                        </button>
                        <input type="file" id="answerFileInput" accept=".txt" hidden>
                        <button class="btn btn-outline" onclick="document.getElementById('answerFileInput').click()">
                            <i class="fas fa-upload"></i> Upload Answer File
                        </button>
                    </div>
                </div>
            </div>

            <!-- File Transfer Section -->
            <div class="section" id="transferSection" style="display: none;">
                <h2><i class="fas fa-exchange-alt"></i> File Transfer</h2>
                
                <!-- File Upload -->
                <div class="transfer-card">
                    <h3><i class="fas fa-upload"></i> Send File</h3>
                    <div class="file-upload-area" id="fileUploadArea">
                        <input type="file" id="fileInput" hidden>
                        <div class="upload-placeholder">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to select a file or drag and drop</p>
                            <span class="file-types">Any file type supported</span>
                        </div>
                        <div class="selected-file" id="selectedFile" style="display: none;">
                            <i class="fas fa-file"></i>
                            <span class="file-name" id="fileName"></span>
                            <span class="file-size" id="fileSize"></span>
                            <button class="btn btn-primary" id="sendFileBtn">
                                <i class="fas fa-paper-plane"></i> Send File
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Transfer Progress -->
                <div class="progress-card" id="progressCard" style="display: none;">
                    <h3 id="progressTitle">Transfer Progress</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-info">
                        <span id="progressText">0%</span>
                        <span id="progressStatus">Preparing...</span>
                    </div>
                </div>

                <!-- Received Files -->
                <div class="transfer-card">
                    <h3><i class="fas fa-inbox"></i> Received Files</h3>
                    <div class="received-files" id="receivedFiles">
                        <div class="empty-state">
                            <i class="fas fa-folder-open"></i>
                            <p>No files received yet</p>
                            <span>Files will appear here when received</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Section -->
            <div class="section" id="chatSection" style="display: none;">
                <h2><i class="fas fa-comments"></i> Chat</h2>
                <div class="chat-card">
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message system">
                            <i class="fas fa-info-circle"></i>
                            <span>Connected! You can now send files and messages.</span>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="messageInput" placeholder="Type a message..." maxlength="500">
                        <button class="btn btn-outline" id="sendMessageBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loadingText">Loading...</p>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification" style="display: none;">
        <div class="notification-content">
            <i class="notification-icon"></i>
            <span class="notification-text"></span>
            <button class="notification-close">&times;</button>
        </div>
    </div>

    <script src="/static/main_script.js"></script>
</body>
</html>
